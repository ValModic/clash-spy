<!DOCTYPE html>
<html lang="sl">
<head>
<meta charset="UTF-8">
<title>Clash Royale Spy – Soft Lavender</title>

<style>
    /* ====== GLOBAL ====== */
    body {
        margin: 0;
        padding: 0;
        font-family: "Inter", sans-serif;
        background: #2a2438; /* soft dark lavender */
        color: #e8e1f0;
        text-align: center;
    }

    h1 {
        font-weight: 700;
        margin-top: 25px;
        color: #dec9ff;
    }

    input, button {
        padding: 12px;
        margin: 6px;
        width: 220px;
        background: #3e335a; 
        border: 1px solid #5c4d85;
        color: #f4eaff;
        border-radius: 10px;
        font-size: 15px;
        transition: 0.15s;
    }

    button:hover {
        background: #54457e;
        cursor: pointer;
    }

    /* Settings gear */
    #settingsBtn {
        position: fixed;
        top: 12px;
        right: 12px;
        font-size: 26px;
        cursor: pointer;
        padding: 10px 12px;
        border-radius: 14px;
        background: #3e335a;
        border: 1px solid #5c4d85;
        transition: 0.2s;
    }
    #settingsBtn:hover {
        background: #54457e;
    }

    /* ====== POPUP (FLIP ANIMATION) ====== */
    #popupWrapper {
        position: fixed;
        inset: 0;
        display: none;
        justify-content: center;
        align-items: center;
        background: rgba(10, 0, 20, 0.55);
        z-index: 50;
    }

    #popup {
        width: 290px;
        padding: 25px;
        background: #3e335a;
        border: 2px solid #5c4d85;
        border-radius: 14px;
        font-size: 18px;
        color: #f1e7ff;
        backface-visibility: hidden;

        /* Card flip origin + animation */
        transform-style: preserve-3d;
        animation: flipIn 0.55s ease forwards;
    }

    @keyframes flipIn {
        0% { transform: rotateY(90deg) scale(0.8); opacity: 0; }
        60% { transform: rotateY(-15deg) scale(1.03); opacity: 1; }
        100% { transform: rotateY(0deg) scale(1); }
    }

    #popup button {
        width: 100%;
        margin-top: 18px;
    }

    /* Disabled buttons after reveal */
    .disabled {
        opacity: 0.45;
        pointer-events: none;
    }

</style>
</head>

<body>

<div id="settingsBtn" onclick="showSettings()">⚙</div>

<div id="setup">
    <h1>Clash Royale Spy</h1>

    <p>Število igralcev:</p>
    <input type="number" id="numPlayers" min="3" max="20" value="4">
    <br>
    <button onclick="confirmPlayers()">Potrdi</button>

    <div id="playersArea"></div>
</div>

<!-- Start / restart -->
<button id="startBtn" style="display:none; margin-top:20px;">Začni igro</button>

<!-- Game info -->
<div id="gameInfo" style="margin-top: 25px; font-size: 20px;"></div>

<!-- ===== POPUP ===== -->
<div id="popupWrapper">
    <div id="popup">
        <div id="popupText"></div>
        <button onclick="closePopup()">Zapri</button>
    </div>
</div>


<script>
/* ALL CLASH ROYALE CARDS */
const cards = [
"Knight","Archers","Goblins","Giant","P.E.K.K.A","Minions","Balloon","Witch","Barbarians","Golem",
"Skeletons","Valkyrie","Skeleton Army","Bomber","Musketeer","Baby Dragon","Prince","Wizard","Mini P.E.K.K.A",
"Spear Goblins","Giant Skeleton","Hog Rider","Minion Horde","Ice Wizard","Royal Giant","Guards","Princess",
"Dark Prince","Three Musketeers","Lava Hound","Ice Spirit","Fire Spirit","Miner","Sparky","Bowler",
"Lumberjack","Battle Ram","Inferno Dragon","Ice Golem","Mega Minion","Dart Goblin","Goblin Gang",
"Electro Wizard","Elite Barbarians","Hunter","Executioner","Bandit","Royal Recruits","Night Witch","Bats",
"Royal Ghost","Ram Rider","Zappies","Rascals","Cannon Cart","Flying Machine","Wall Breakers","Royal Hogs",
"Goblin Giant","Fisherman","Magic Archer","Electro Dragon","Firecracker","Mighty Miner","Elixir Golem",
"Goblin Barrel","Freeze","Mirror","Lightning","Zap","Poison","Graveyard","The Log","Tornado","Clone",
"Earthquake","Barbarian Barrel","Heal Spirit","Giant Snowball","Royal Delivery"
];

let players = [];
let spyIndex = -1;
let chosenCard = "";

/* === Show inputs for names === */
function confirmPlayers() {
    const n = parseInt(document.getElementById("numPlayers").value);

    if (n < 3) return popupMsg("Rabiš vsaj 3 igralce.");

    const area = document.getElementById("playersArea");
    area.innerHTML = "";

    for (let i = 0; i < n; i++) {
        area.innerHTML += `<input id="p${i}" placeholder="Ime ${i+1} (opcijsko)"><br>`;
    }

    document.getElementById("startBtn").style.display = "inline-block";
    document.getElementById("startBtn").onclick = startGame;
}

/* === POPUP === */
function popupMsg(msg) {
    document.getElementById("popupText").innerText = msg;

    // Replay animation cleanly
    const card = document.getElementById("popup");
    card.style.animation = "none";
    void card.offsetWidth;
    card.style.animation = "flipIn 0.55s ease forwards";

    document.getElementById("popupWrapper").style.display = "flex";
}

function closePopup() {
    document.getElementById("popupWrapper").style.display = "none";
}

/* === START / PLAY === */
function startGame() {
    players = [];
    const n = parseInt(document.getElementById("numPlayers").value);

    for (let i = 0; i < n; i++) {
        let name = document.getElementById("p"+i).value.trim();
        if (!name) name = "Igralec " + (i+1);
        players.push(name);
    }

    document.getElementById("setup").style.display = "none";

    spyIndex = Math.floor(Math.random() * players.length);
    chosenCard = cards[Math.floor(Math.random() * cards.length)];

    const starter = players[Math.floor(Math.random() * players.length)];

    let html = `<b>Začne: ${starter}</b><br><br>`;

    for (let i = 0; i < players.length; i++) {
        html += `<button id="btn${i}" onclick="reveal(${i})">${players[i]}</button><br>`;
    }

    document.getElementById("gameInfo").innerHTML = html;

    const btn = document.getElementById("startBtn");
    btn.textContent = "Ponovna igra";
    btn.onclick = () => location.reload();
}

/* === REVEAL === */
function reveal(i) {
    if (i === spyIndex) popupMsg(players[i] + " – ti si SPY!");
    else popupMsg(players[i] + " – tvoja karta je: " + chosenCard);

    const btn = document.getElementById("btn"+i);
    btn.classList.add("disabled");
    btn.disabled = true;
}

/* === SETTINGS BUTTON === */
function showSettings() {
    document.getElementById("setup").style.display = "block";
}

</script>

</body>
</html>
