<!DOCTYPE html>
<html lang="sl">
<head>
<meta charset="UTF-8">
<title>Clash Royale Spy – Dark</title>
<style>
    body {
        background: #121212;
        color: #eaeaea;
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        text-align: center;
    }

    .container {
        margin-top: 40px;
    }

    input, button {
        padding: 10px;
        margin: 5px;
        background: #1e1e1e;
        border: 1px solid #444;
        color: white;
        border-radius: 5px;
    }

    button:hover {
        background: #333;
        cursor: pointer;
    }

    #playersArea {
        margin-top: 20px;
    }

    /* Gear icon */
    #settingsBtn {
        position: fixed;
        top: 10px;
        right: 10px;
        font-size: 26px;
        cursor: pointer;
        padding: 8px;
        border-radius: 10px;
        background: #1e1e1e;
        border: 1px solid #444;
    }

    #settingsBtn:hover {
        background: #333;
    }

    /* Popup */
    #popup {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: #1e1e1e;
        padding: 30px;
        border: 2px solid #444;
        border-radius: 10px;
        display: none;
        z-index: 100;
        width: 300px;
    }

    #popup button {
        margin-top: 15px;
        width: 100%;
    }

    .disabled {
        opacity: 0.5;
        cursor: not-allowed;
    }
</style>
</head>
<body>

<div id="settingsBtn" onclick="showSettings()">⚙</div>

<div class="container" id="setup">

    <h1>Clash Royale Spy</h1>

    <label>Število igralcev:</label>
    <input type="number" id="numPlayers" min="3" max="20" value="4">
    <br>
    <button onclick="confirmPlayers()">Potrdi</button>

    <div id="playersArea"></div>
</div>

<button id="startBtn" style="display:none;" onclick="startGame()">Začni igro</button>

<div id="gameInfo" style="margin-top: 20px; font-size:20px;"></div>

<!-- Popup -->
<div id="popup">
    <div id="popupText"></div>
    <button onclick="closePopup()">Zapri</button>
</div>

<script>
const cards = [
"Knight","Archers","Goblins","Giant","P.E.K.K.A","Minions","Balloon","Witch","Barbarians","Golem",
"Skeletons","Valkyrie","Skeleton Army","Bomber","Musketeer","Baby Dragon","Prince","Wizard","Mini P.E.K.K.A",
"Spear Goblins","Giant Skeleton","Hog Rider","Minion Horde","Ice Wizard","Royal Giant","Guards","Princess",
"Dark Prince","Three Musketeers","Lava Hound","Ice Spirit","Fire Spirit","Miner","Sparky","Bowler",
"Lumberjack","Battle Ram","Inferno Dragon","Ice Golem","Mega Minion","Dart Goblin","Goblin Gang",
"Electro Wizard","Elite Barbarians","Hunter","Executioner","Bandit","Royal Recruits","Night Witch","Bats",
"Royal Ghost","Ram Rider","Zappies","Rascals","Cannon Cart","Flying Machine","Wall Breakers","Royal Hogs",
"Goblin Giant","Fisherman","Magic Archer","Electro Dragon","Firecracker","Mighty Miner","Elixir Golem",
"Goblin Barrel","Freeze","Mirror","Lightning","Zap","Poison","Graveyard","The Log","Tornado","Clone",
"Earthquake","Barbarian Barrel","Heal Spirit","Giant Snowball","Royal Delivery"
];

let players = [];
let spyIndex = -1;
let chosenCard = "";

// Show name inputs
function confirmPlayers() {
    let n = parseInt(document.getElementById("numPlayers").value);
    if (n < 3) { popupMsg("Rabiš vsaj 3 igralce."); return; }

    let area = document.getElementById("playersArea");
    area.innerHTML = "";

    for (let i = 0; i < n; i++) {
        area.innerHTML += `<input id="p${i}" placeholder="Ime igralca ${i+1} (opcijsko)"> <br>`;
    }

    document.getElementById("startBtn").style.display = "inline-block";
}

// Open popup
function popupMsg(msg) {
    document.getElementById("popupText").innerText = msg;
    document.getElementById("popup").style.display = "block";
}

function closePopup() {
    document.getElementById("popup").style.display = "none";
}

// Start game
function startGame() {
    // Collect player names
    players = [];
    const n = parseInt(document.getElementById("numPlayers").value);

    for (let i = 0; i < n; i++) {
        let name = document.getElementById("p"+i).value.trim();
        if (name === "") name = "Igralec " + (i+1);
        players.push(name);
    }

    // Hide setup
    document.getElementById("setup").style.display = "none";

    // Random spy + card
    spyIndex = Math.floor(Math.random() * players.length);
    chosenCard = cards[Math.floor(Math.random() * cards.length)];

    // Random player starts
    let starter = players[Math.floor(Math.random() * players.length)];
    document.getElementById("gameInfo").innerHTML = 
        "<b>Začne: " + starter + "</b>";

    // Change start button → restart
    let btn = document.getElementById("startBtn");
    btn.textContent = "Ponovna igra";
    btn.onclick = resetGame;

    // Show buttons to reveal card
    let out = "";
    for (let i = 0; i < players.length; i++) {
        out += `<button id="btn${i}" onclick="reveal(${i})">${players[i]}</button><br>`;
    }
    document.getElementById("gameInfo").innerHTML += "<br><br>" + out;
}

// Reveal card for a player
function reveal(i) {
    let btn = document.getElementById("btn"+i);

    if (i === spyIndex) popupMsg(players[i] + ", ti si SPY!");
    else popupMsg(players[i] + ", tvoja karta je: " + chosenCard);

    btn.classList.add("disabled");
    btn.disabled = true;
}

// Reset game
function resetGame() {
    location.reload();
}

// Open settings (show setup again)
function showSettings() {
    document.getElementById("setup").style.display = "block";
}
</script>

</body>
</html>
